# E-Book to PDF

전자책 뷰어의 특정 영역을 자동으로 스크린샷하고, 페이지를 넘기며, 캡처된 이미지들을 하나의 PDF 파일로 합치는 GUI 애플리케이션입니다.

---

## 설치 및 실행

### 1. 프로젝트 복제 및 이동
```bash
git clone https://github.com/pargamer/E-Book2PDF.git
cd E-Book2PDF
```

### 2. 가상 환경 설정 및 라이브러리 설치
독립된 가상 환경에서 프로젝트에 필요한 라이브러리들을 설치합니다.
```bash
# 가상 환경 생성
python3 -m venv venv

# 가상 환경 활성화 (macOS/Linux)
source venv/bin/activate

# 필수 라이브러리 설치
pip install -r requirements.txt
```

### 3. 애플리케이션 실행
모든 설정이 완료되고 **가상 환경이 활성화된 상태**에서, 아래 명령어로 GUI 애플리케이션을 실행합니다.
```bash
python3 app.py
```

### 4. 가상 환경 종료
작업이 끝나면 아래 명령어로 가상 환경을 비활성화할 수 있습니다.
```bash
deactivate
```

## 사용 방법

1.  **시작**: 첫 화면에서 '시작' 버튼을 클릭하여 메인 설정 화면으로 이동합니다.
2.  **스크린샷 범위 설정**:
    - '스크린샷 범위 설정' 버튼을 클릭합니다.
    - "N초 후 마우스 위치를 캡처합니다"라는 안내가 나오면, 원하는 위치로 마우스 커서를 이동하고 기다립니다.
    - '왼쪽 상단'과 '오른쪽 하단'을 차례로 설정합니다.
3.  **페이지 수 입력**: 캡처할 총 페이지 수를 입력합니다.
4.  **페이지 넘김 방식 선택**:
    - **키보드**: '키보드' 라디오 버튼을 선택하면 키 입력 화면으로 자동 전환됩니다. 페이지 넘김에 사용할 키(예: 오른쪽 화살표)를 누르면 설정이 저장되고 메인 화면으로 돌아옵니다.
    - **마우스 클릭**: '마우스 클릭' 라디오 버튼을 선택하고, '클릭 위치 설정' 버튼을 눌러 페이지 넘김에 사용할 영역을 클릭합니다.
5.  **딜레이 설정**: 페이지 넘김 후 다음 캡처까지의 대기 시간(초)을 설정합니다. (기본값 1.5초)
6.  **프로그램 시작**: 모든 설정이 완료되면 '프로그램 시작' 버튼을 누르세요. 5초의 준비 시간이 주어지며, 이 시간 동안 캡처할 창을 화면 맨 앞으로 활성화해야 합니다. 작업이 시작되면 하단 상태바에 진행 상황이 표시됩니다.
7.  **완료**: 작업이 끝나면 "작업 완료!" 메시지가 표시되고, `PDFs` 폴더 안에 결과물이 저장됩니다. 임시 스크린샷 이미지들은 자동으로 삭제됩니다.

## 문제 해결 (Troubleshooting)

### 스크린샷이 저장되지 않는 경우
프로그램의 상태바에 "캡처 실패! 권한을 확인하세요." 메시지가 표시되면, macOS의 **화면 기록** 권한이 제대로 적용되지 않은 것입니다.
1.  **`시스템 설정`** > **`개인정보 및 보안`** > **`화면 기록`**으로 이동합니다.
2.  목록에서 현재 사용 중인 터미널 앱(예: `Terminal`, `iTerm`)을 **(-) 버튼으로 제거**합니다.
3.  **(+) 버튼을 눌러 터미널 앱을 다시 추가**하고 활성화합니다.
4.  **터미널과 앱을 완전히 종료한 후 다시 실행**합니다. 권한을 갱신하기 위해 이 과정이 필수적입니다.

## 주의사항
- 스크린샷 작업이 시작되면 완료될 때까지 컴퓨터 사용을 중단하는 것이 좋습니다.
- **작업 중단**: 작업 진행 중 아무 키나 누르면 프로세스가 즉시 안전하게 중단됩니다.
- `PDFs` 폴더는 프로그램이 자동으로 생성하며, Git 추적에서 제외됩니다.

---
## 최신 변경사항
- **2025.07.30**:
    - 스크린샷 로직을 '전체 화면 캡처 후 후처리로 자르기' 방식으로 변경하여 macOS에서의 치명적인 충돌 및 강제 종료 문제 해결.
    - 스크린샷 저장 실패 시 원인을 명확히 알 수 있도록 디버깅 로직 강화.
    - `README.md`에 가상환경 종료 명령어 및 문제 해결 가이드 추가.
    - 작업 중단 기능 추가, 좌표 설정 방식 개선 등 안정성 강화.
